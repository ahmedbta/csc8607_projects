# Configuration for the CelebA multi-label classification project
dataset:
  name: "CelebA"
  root: "./data"
  attributes: ["Smiling", "Wearing_Hat", "Male", "Young", "Eyeglasses"]
  download: true
  num_workers: 4
  shuffle: true

preprocess:
  resize: [64, 64]
  normalize: {"mean": [0.5, 0.5, 0.5], "std": [0.5, 0.5, 0.5]}

augment:
  random_flip: true
  random_rotation:
    enabled: true
    degrees: 15
  color_jitter:
    enabled: true
    brightness: 0.2
    contrast: 0.2
    saturation: 0.2
    hue: 0.1

model:
  type: "cnn_multilabel"
  num_classes: 5
  input_shape: [3, 64, 64]
  # Hyperparameters chosen from grid search
  channels_block3: 192
  dropout: 0.0 # Changed for single combination run

train:
  seed: 42
  device: auto
  batch_size: 64
  epochs: 20
  max_steps: null
  overfit_small: false

  optimizer:
    name: adam
    lr: 0.001 # Changed for single combination run
    weight_decay: 0.0 # Changed for single combination run
    momentum: 0.9

  scheduler:
    name: none

metrics:
  classification:
    - accuracy

hparams:
  lr: [0.001] # Single value for grid search
  weight_decay: [0.0] # Single value for grid search
  model:
    channels_block3: [192] # Single value for grid search
    dropout: [0.0] # Single value for grid search

paths:
  runs_dir: "./runs"
  artifacts_dir: "./artifacts"